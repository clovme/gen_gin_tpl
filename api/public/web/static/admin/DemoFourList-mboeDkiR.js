import{d as V,r as c,b as C,c as v,i as k,o as h,w as l,g as u,m as P,X as R,h as b,V as D,t as B,e as E,z as S,j as I}from"./index-Dydifo4O.js";import{a as T,b as U,p as q,g as F,d as N}from"./demo-BIhve4sl.js";const L=V({__name:"DetailsDrawer",setup(A,{expose:_}){const f=c(!1),s=c(!1),x=c(""),o=C({titleWidth:100,titleColon:!0,titleAlign:"right",border:!0,titleBackground:!0,data:null,items:[{field:"name",title:"名称",span:12},{field:"code",title:"编码",span:12},{field:"nickname",title:"昵称",span:12},{field:"amount",title:"金额",span:12},{field:"commenceDate",title:"开工时间",span:12},{field:"describe",title:"描述",span:24}]}),r=async()=>{s.value=!0,o.data=null;try{const d=(await T({id:x.value})).data;o.data=d}catch{}finally{s.value=!1}};return _({open(n){x.value=n,f.value=!0,r()}}),(n,d)=>{const p=v("vxe-form"),y=v("vxe-drawer");return h(),k(y,{"show-footer":"","show-confirm-button":"","destroy-on-close":"","confirm-button-text":"关闭",width:"60vw",modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=e=>f.value=e),title:"详情",loading:s.value},{default:l(()=>[u(p,P({ref:"formRef"},o),null,16)]),_:1},8,["modelValue","loading"])}}}),O=V({__name:"EditDrawer",emits:["save","add"],setup(A,{expose:_,emit:f}){const s=f,x=c(),o=c(!1),r=c(!1),n=c(""),d={_id:"",name:"",nickname:"",code:"",amount:null,commenceDate:"",describe:""},p=C({titleWidth:80,titleColon:!0,titleAlign:"right",data:R.clone(d,!0),rules:{name:[{required:!0,message:"请输入名称"}]},items:[{field:"name",title:"名称",span:12,itemRender:{name:"VxeInput"}},{field:"code",title:"编码",span:12,itemRender:{name:"VxeInput"}},{field:"nickname",title:"昵称",span:12,itemRender:{name:"VxeInput"}},{field:"amount",title:"金额",span:12,itemRender:{name:"VxeNumberInput"}},{field:"commenceDate",title:"开工时间",span:12,itemRender:{name:"VxeDatePicker"}},{field:"describe",title:"描述",span:24,itemRender:{name:"VxeTextarea"}}]}),y=async()=>{r.value=!0;try{const a=(await T({id:n.value})).data;p.data=a}catch{}finally{r.value=!1}},e=()=>{o.value=!1},t=async()=>{r.value=!0;try{await U({...p.data,_id:n.value}),D.modal.message({content:"保存成功",status:"success"}),o.value=!1,s(n.value?"save":"add")}catch{}finally{r.value=!1}};return _({add(){n.value="",o.value=!0,p.data=R.clone(d,!0)},edit(i){n.value=i,o.value=!0,p.data=R.clone(d,!0),y()}}),(i,a)=>{const g=v("vxe-form"),m=v("vxe-button"),w=v("vxe-drawer");return h(),k(w,{"show-footer":"","destroy-on-close":"",modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=$=>o.value=$),width:"60vw",title:n.value?"编辑":"新增",loading:r.value},{footer:l(()=>[u(m,{onClick:e},{default:l(()=>a[1]||(a[1]=[b("取消",-1)])),_:1,__:[1]}),u(m,{type:"reset",icon:"vxe-icon-repeat",disabled:r.value},{default:l(()=>a[2]||(a[2]=[b("重置",-1)])),_:1,__:[2]},8,["disabled"]),u(m,{type:"submit",status:"primary",icon:"vxe-icon-search",disabled:r.value,onClick:t},{default:l(()=>a[3]||(a[3]=[b("保存",-1)])),_:1,__:[3]},8,["disabled"])]),default:l(()=>[u(g,P({ref_key:"formRef",ref:x},p),null,16)]),_:1},8,["modelValue","title","loading"])}}}),W={key:1},H=V({__name:"DemoFourList",setup(A){const _=c(),f=c(),s=c(),x=C({id:"DemoFourList",height:"100%",keepSource:!0,showOverflow:!0,rowConfig:{isHover:!0},sortConfig:{remote:!0,multiple:!0},customConfig:{storage:!0},toolbarConfig:{refresh:!0,zoom:!0,buttons:[{name:"新增",code:"ADD",status:"primary",icon:"vxe-icon-add",permissionCode:"demoThreeActionInsert"},{name:"批量删除",code:"delete",status:"error",icon:"vxe-icon-delete",permissionCode:"demoThreeActionDelete"}]},formConfig:{titleWidth:80,titleAlign:"right",items:[{field:"name",title:"名称",span:6,itemRender:{name:"VxeInput"}},{field:"nickname",title:"昵称",span:6,itemRender:{name:"VxeInput"}},{field:"code",title:"编码",span:6,itemRender:{name:"VxeInput"}},{field:"amount",title:"金额",span:6,itemRender:{name:"VxeNumberInput"}},{field:"startDate",title:"开始时间",span:6,folding:!0,itemRender:{name:"VxeDatePicker",props:{clearable:!0}}},{field:"endDate",title:"结束时间",span:6,folding:!0,itemRender:{name:"VxeDatePicker",props:{clearable:!0}}},{span:24,align:"center",collapseNode:!0,itemRender:{name:"ListSearchBtn"}}]},pagerConfig:{},columns:[{type:"checkbox",width:60},{type:"seq",width:70},{field:"name",title:"名称",minWidth:200,slots:{default:"default_name"}},{field:"code",title:"编码",sortable:!0,width:200},{field:"amount",title:"金额",sortable:!0,width:200},{field:"nickname",title:"昵称",sortable:!0,width:200},{field:"commenceDate",title:"开工日期",formatter:"FormatDateDefault",width:200},{field:"describe",title:"描述",width:200},{field:"updateTime",title:"最后更新时间",width:160,formatter:"FormatDateTime",sortable:!0},{field:"createTime",title:"创建时间",width:160,formatter:"FormatDateTime",sortable:!0},{field:"action",title:"操作",fixed:"right",width:160,slots:{default:"action"}}],proxyConfig:{form:!0,sort:!0,ajax:{query({page:e,form:t,sorts:i}){const a={...e,...t,orderBy:i.map(g=>`${g.field}|${g.order}`).join(",")};return F(a)},delete({body:e}){return q({...e})}}}}),o={toolbarButtonClick({code:e}){var t;switch(e){case"ADD":(t=f.value)==null||t.add();break}}},r=e=>{var t;(t=_.value)==null||t.open(e._id)},n=e=>{var t;(t=f.value)==null||t.edit(e._id)},d=async e=>{const t=s.value;if(t&&t.isInsertByRow(e)){t.remove(e);return}await D.modal.confirm({content:`请确认是否删除 “ ${e.name} ”？`})==="confirm"&&N({_id:e._id}).then(()=>{t&&t.commitProxy("query"),D.modal.message({content:"删除成功",status:"success"})})},p=()=>{const e=s.value;e&&e.commitProxy("query")},y=()=>{const e=s.value;e&&e.commitProxy("reload")};return(e,t)=>{const i=v("vxe-button"),a=v("vxe-grid"),g=v("PageView");return h(),k(g,null,{default:l(()=>[u(a,P({ref_key:"gridRef",ref:s},x,B(o)),{default_name:l(({row:m})=>[S(D).permission.checkVisible("demoThreeActionUpdate")?(h(),k(i,{key:0,mode:"text",status:"primary",onClick:w=>r(m)},{default:l(()=>[b(I(m.name),1)]),_:2},1032,["onClick"])):(h(),E("span",W,I(m.name),1))]),action:l(({row:m})=>[u(i,{mode:"text",status:"primary",icon:"vxe-icon-edit","permission-code":"demoThreeActionUpdate",onClick:w=>n(m)},{default:l(()=>t[0]||(t[0]=[b("编辑",-1)])),_:2,__:[0]},1032,["onClick"]),u(i,{mode:"text",status:"error",icon:"vxe-icon-delete",onClick:w=>d(m),"permission-code":"demoThreeActionDelete"},{default:l(()=>t[1]||(t[1]=[b("删除",-1)])),_:2,__:[1]},1032,["onClick"])]),_:1},16),u(L,{ref_key:"detailsRef",ref:_},null,512),u(O,{ref_key:"editRef",ref:f,onSave:p,onAdd:y},null,512)]),_:1})}}});export{H as default};
