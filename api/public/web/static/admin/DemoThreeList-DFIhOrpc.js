import{d as V,r as c,b as C,c as v,i as w,o as y,w as l,g as u,m as P,X as R,h,V as k,t as B,e as E,z as S,j as I}from"./index-Dydifo4O.js";import{a as T,b as U,p as q,g as N,d as z}from"./demo-BIhve4sl.js";const L=V({__name:"DetailsPopup",setup(A,{expose:_}){const f=c(!1),r=c(!1),x=c(""),a=C({titleWidth:100,titleColon:!0,titleAlign:"right",border:!0,titleBackground:!0,data:null,items:[{field:"name",title:"名称",span:12},{field:"code",title:"编码",span:12},{field:"nickname",title:"昵称",span:12},{field:"amount",title:"金额",span:12},{field:"commenceDate",title:"开工时间",span:12},{field:"describe",title:"描述",span:24}]}),s=async()=>{r.value=!0,a.data=null;try{const d=(await T({id:x.value})).data;a.data=d}catch{}finally{r.value=!1}};return _({open(n){x.value=n,f.value=!0,s()}}),(n,d)=>{const p=v("vxe-form"),b=v("vxe-modal");return y(),w(b,{"show-footer":"","show-confirm-button":"","destroy-on-close":"",resize:"","confirm-button-text":"关闭",width:"70vw",height:"60vh",modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=e=>f.value=e),title:"详情",loading:r.value},{default:l(()=>[u(p,P({ref:"formRef"},a),null,16)]),_:1},8,["modelValue","loading"])}}}),O=V({__name:"EditPopup",emits:["save","add"],setup(A,{expose:_,emit:f}){const r=f,x=c(),a=c(!1),s=c(!1),n=c(""),d={_id:"",name:"",nickname:"",code:"",amount:null,commenceDate:"",describe:""},p=C({titleWidth:80,titleColon:!0,titleAlign:"right",data:R.clone(d,!0),rules:{name:[{required:!0,message:"请输入名称"}]},items:[{field:"name",title:"名称",span:12,itemRender:{name:"VxeInput"}},{field:"code",title:"编码",span:12,itemRender:{name:"VxeInput"}},{field:"nickname",title:"昵称",span:12,itemRender:{name:"VxeInput"}},{field:"amount",title:"金额",span:12,itemRender:{name:"VxeNumberInput"}},{field:"commenceDate",title:"开工时间",span:12,itemRender:{name:"VxeDatePicker"}},{field:"describe",title:"描述",span:24,itemRender:{name:"VxeTextarea"}}]}),b=async()=>{s.value=!0;try{const o=(await T({id:n.value})).data;p.data=o}catch{}finally{s.value=!1}},e=()=>{a.value=!1},t=async()=>{s.value=!0;try{await U({...p.data,_id:n.value}),k.modal.message({content:"保存成功",status:"success"}),a.value=!1,r(n.value?"save":"add")}catch{}finally{s.value=!1}};return _({add(){n.value="",a.value=!0,p.data=R.clone(d,!0)},edit(i){n.value=i,a.value=!0,p.data=R.clone(d,!0),b()}}),(i,o)=>{const g=v("vxe-form"),m=v("vxe-button"),D=v("vxe-modal");return y(),w(D,{"show-footer":"","destroy-on-close":"",resize:"",width:"70vw",height:"60vh",modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=$=>a.value=$),title:n.value?"编辑":"新增",loading:s.value},{footer:l(()=>[u(m,{onClick:e},{default:l(()=>o[1]||(o[1]=[h("取消",-1)])),_:1,__:[1]}),u(m,{type:"reset",icon:"vxe-icon-repeat",disabled:s.value},{default:l(()=>o[2]||(o[2]=[h("重置",-1)])),_:1,__:[2]},8,["disabled"]),u(m,{type:"submit",status:"primary",icon:"vxe-icon-search",disabled:s.value,onClick:t},{default:l(()=>o[3]||(o[3]=[h("保存",-1)])),_:1,__:[3]},8,["disabled"])]),default:l(()=>[u(g,P({ref_key:"formRef",ref:x},p),null,16)]),_:1},8,["modelValue","title","loading"])}}}),W={key:1},H=V({__name:"DemoThreeList",setup(A){const _=c(),f=c(),r=c(),x=C({id:"DemoThreeList",height:"100%",keepSource:!0,showOverflow:!0,rowConfig:{isHover:!0},sortConfig:{remote:!0,multiple:!0},customConfig:{storage:!0},toolbarConfig:{refresh:!0,zoom:!0,buttons:[{name:"新增",code:"ADD",status:"primary",icon:"vxe-icon-add",permissionCode:"demoThreeActionInsert"},{name:"批量删除",code:"delete",status:"error",icon:"vxe-icon-delete",permissionCode:"demoThreeActionDelete"}]},formConfig:{titleWidth:80,titleAlign:"right",items:[{field:"name",title:"名称",span:6,itemRender:{name:"VxeInput"}},{field:"nickname",title:"昵称",span:6,itemRender:{name:"VxeInput"}},{field:"code",title:"编码",span:6,itemRender:{name:"VxeInput"}},{field:"amount",title:"金额",span:6,itemRender:{name:"VxeNumberInput"}},{field:"startDate",title:"开始时间",span:6,folding:!0,itemRender:{name:"VxeDatePicker",props:{clearable:!0}}},{field:"endDate",title:"结束时间",span:6,folding:!0,itemRender:{name:"VxeDatePicker",props:{clearable:!0}}},{span:24,align:"center",collapseNode:!0,itemRender:{name:"ListSearchBtn"}}]},pagerConfig:{},columns:[{type:"checkbox",width:60},{type:"seq",width:70},{field:"name",title:"名称",minWidth:200,slots:{default:"default_name"}},{field:"code",title:"编码",sortable:!0,width:200},{field:"amount",title:"金额",sortable:!0,width:200},{field:"nickname",title:"昵称",sortable:!0,width:200},{field:"commenceDate",title:"开工日期",formatter:"FormatDateDefault",width:200},{field:"describe",title:"描述",width:200},{field:"updateTime",title:"最后更新时间",width:160,formatter:"FormatDateTime",sortable:!0},{field:"createTime",title:"创建时间",width:160,formatter:"FormatDateTime",sortable:!0},{field:"action",title:"操作",fixed:"right",width:160,slots:{default:"action"}}],proxyConfig:{form:!0,sort:!0,ajax:{query({page:e,form:t,sorts:i}){const o={...e,...t,orderBy:i.map(g=>`${g.field}|${g.order}`).join(",")};return N(o)},delete({body:e}){return q({...e})}}}}),a={toolbarButtonClick({code:e}){var t;switch(e){case"ADD":(t=f.value)==null||t.add();break}}},s=e=>{var t;(t=_.value)==null||t.open(e._id)},n=e=>{var t;(t=f.value)==null||t.edit(e._id)},d=async e=>{const t=r.value;if(t&&t.isInsertByRow(e)){t.remove(e);return}await k.modal.confirm({content:`请确认是否删除 “ ${e.name} ”？`})==="confirm"&&z({_id:e._id}).then(()=>{t&&t.commitProxy("query"),k.modal.message({content:"删除成功",status:"success"})})},p=()=>{const e=r.value;e&&e.commitProxy("query")},b=()=>{const e=r.value;e&&e.commitProxy("reload")};return(e,t)=>{const i=v("vxe-button"),o=v("vxe-grid"),g=v("PageView");return y(),w(g,null,{default:l(()=>[u(o,P({ref_key:"gridRef",ref:r},x,B(a)),{default_name:l(({row:m})=>[S(k).permission.checkVisible("demoThreeActionUpdate")?(y(),w(i,{key:0,mode:"text",status:"primary",onClick:D=>s(m)},{default:l(()=>[h(I(m.name),1)]),_:2},1032,["onClick"])):(y(),E("span",W,I(m.name),1))]),action:l(({row:m})=>[u(i,{mode:"text",status:"primary",icon:"vxe-icon-edit","permission-code":"demoThreeActionUpdate",onClick:D=>n(m)},{default:l(()=>t[0]||(t[0]=[h("编辑",-1)])),_:2,__:[0]},1032,["onClick"]),u(i,{mode:"text",status:"error",icon:"vxe-icon-delete",onClick:D=>d(m),"permission-code":"demoThreeActionDelete"},{default:l(()=>t[1]||(t[1]=[h("删除",-1)])),_:2,__:[1]},1032,["onClick"])]),_:1},16),u(L,{ref_key:"detailsRef",ref:_},null,512),u(O,{ref_key:"editRef",ref:f,onSave:p,onAdd:b},null,512)]),_:1})}}});export{H as default};
