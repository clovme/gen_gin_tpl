import{d as g,r as h,b as a,V as o,c as i,i as x,o as _,w as c,g as d,m as v}from"./index-Cvc_Iv1t.js";import{p as C,g as b,d as w}from"./permissions-FOMy8IFo.js";import{g as A}from"./route-B_K32uly.js";const V=g({__name:"PermissionsManageList",setup(y){const s=h(),n=a({name:"VxeTreeSelect",options:[],optionProps:{value:"code",label:"name"},props:{multiple:!0,clearable:!0,treeConfig:{transform:!0,keyField:"code",parentField:"parentCode",showCheckbox:!0,checkboxConfig:{checkStrictly:!0}}}});A({}).then(e=>{n.options=e.data});const m=a({id:"PermissionsManageList",height:"100%",keepSource:!0,showOverflow:!0,rowConfig:{isHover:!0},treeConfig:{transform:!0,rowField:"code",parentField:"parentCode",expandAll:!0},editConfig:{mode:"row",showStatus:!0,enabled:o.permission.checkVisible("permissionsManageActionInsert|permissionsManageActionUpdate")},customConfig:{storage:!0},toolbarConfig:{refresh:!0,zoom:!0,buttons:[{name:"新增",code:"insert_edit",status:"primary",icon:"vxe-icon-add",permissionCode:"permissionsManageActionInsert"},{name:"标记/删除",code:"mark_cancel",status:"error",icon:"vxe-icon-delete",permissionCode:"permissionsManageActionDelete"},{name:"保存",code:"save",status:"success",icon:"vxe-icon-save",permissionCode:"permissionsManageActionInsert|permissionsManageActionDelete|permissionsManageActionUpdate"}]},editRules:{name:[{required:!0,message:"请输入权限名称"}]},columns:[{type:"checkbox",width:60},{type:"seq",width:70},{field:"code",title:"权限编码",width:300,visible:!1},{field:"name",title:"权限名称",treeNode:!0,minWidth:300,editRender:{name:"VxeInput"}},{field:"routeCodes",title:"关联路由",minWidth:500,editRender:n},{field:"updateTime",title:"最后更新时间",width:160,formatter:"FormatDateTime"},{field:"createTime",title:"创建时间",width:160,formatter:"FormatDateTime"},{field:"action",title:"操作",fixed:"right",width:80,slots:{default:"action"}}],proxyConfig:{ajax:{query({page:e}){const t={...e};return b(t)},save({body:e}){return C(e)}}}}),l=async e=>{const t=s.value;if(t&&t.isInsertByRow(e)){t.remove(e);return}await o.modal.confirm({content:`请确认是否删除 “ ${e.name} ”？`})==="confirm"&&w({_id:e._id}).then(()=>{t&&t.commitProxy("query"),o.modal.message({content:"删除成功",status:"success"})})};return(e,t)=>{const r=i("vxe-button"),u=i("vxe-grid"),p=i("PageView");return _(),x(p,null,{default:c(()=>[d(u,v({ref_key:"gridRef",ref:s},m),{action:c(({row:f})=>[d(r,{mode:"text",status:"error",icon:"vxe-icon-delete","permission-code":"permissionsManageActionDelete",onClick:P=>l(f)},null,8,["onClick"])]),_:1},16)]),_:1})}}});export{V as default};
